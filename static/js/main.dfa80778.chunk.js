(this.webpackJsonpgallery=this.webpackJsonpgallery||[]).push([[0],{20:function(e,t,n){e.exports=n(40)},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(10),o=n.n(r),c=n(1),l=n(3),s=n(2),m=n(4),u={editableItemId:null,items:JSON.parse(localStorage.getItem("items")||"[]"),form:{isVisible:!1,newItem:{link:"",comment:""}},preview:{isVisible:!1},preloader:{isVisible:!1},imageModal:{link:"",isVisible:!1}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_FORM_VISIBILITY":return Object(s.a)({},e,{form:Object(s.a)({},e.form,{isVisible:t.payload})});case"SAVE_NEW_ITEM":return Object(s.a)({},e,{form:Object(s.a)({},e.form,{newItem:t.payload})});case"CHANGE_PREVIEW_STATUS":return Object(s.a)({},e,{preview:{isVisible:t.payload}});case"CHANGE_PRELOADER_VISIBILITY":return Object(s.a)({},e,{preloader:{isVisible:t.payload}});case"SET_ITEMS":return Object(s.a)({},e,{items:t.payload});case"SET_NEW_ITEM":return Object(s.a)({},e,{items:[t.payload].concat(Object(l.a)(e.items))});case"SET_ID_FOR_EDIT":return Object(s.a)({},e,{editableItemId:t.payload});case"EDIT_ITEM":var n=t.payload.id,a=e.items.findIndex((function(e){return e.id===n})),i=e.items[a];return Object(s.a)({},e,{items:[].concat(Object(l.a)(e.items.slice(0,a)),[Object(s.a)({},i,{comment:t.payload.comment})],Object(l.a)(e.items.slice(a+1)))});case"IMAGE_MODAL_TOGGLE":return Object(s.a)({},e,{imageModal:t.payload});default:return e}},p={notifications:[]},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APPEND_NOTIFICATION":return{notifications:[t.payload].concat(Object(l.a)(e.notifications))};case"HIDE_NOTIFICATION":var n=t.payload,a=e.notifications.findIndex((function(e){return e.id===n})),i=e.notifications[a];return{notifications:[].concat(Object(l.a)(e.notifications.slice(0,a)),[Object(s.a)({},i,{isVisible:!1})],Object(l.a)(e.notifications.slice(a+1)))};case"REMOVE_NOTIFICATION":var r=t.payload;return{notifications:e.notifications.filter((function(e){return e.id!==r}))};default:return e}},E=Object(m.c)({gallery:d,notification:f}),b=n(17),_=Object(m.d)(E,Object(m.a)(b.a)),g=function(e){return{type:"CHANGE_FORM_VISIBILITY",payload:e}},v=function(e){return{type:"SAVE_NEW_ITEM",payload:{link:e.link,comment:e.comment}}},N=function(e){return{type:"CHANGE_PREVIEW_STATUS",payload:e}},I=function(e){return{type:"SET_ITEMS",payload:e}},h=function(e){return{type:"SET_ID_FOR_EDIT",payload:e}},y=function(e){return{type:"IMAGE_MODAL_TOGGLE",payload:e}},O=function(e){return function(t){var n=Date.now();t(function(e){return{type:"APPEND_NOTIFICATION",payload:e}}({id:n,message:e,isVisible:!0})),setTimeout((function(){return t((e=n,console.log(e),{type:"HIDE_NOTIFICATION",payload:e}));var e}),4e3),setTimeout((function(){return t({type:"REMOVE_NOTIFICATION",payload:n})}),5e3)}},w=(n(31),Object(c.b)(null,(function(e){return{openForm:function(){return e(g(!0))}}}))((function(e){var t=e.openForm;return i.a.createElement("header",{className:"header"},i.a.createElement("div",{className:"header__logo"},"Sky Gallery"),i.a.createElement("button",{className:"header__add-new",onClick:t},i.a.createElement("i",{className:"material-icons"},"add"),i.a.createElement("span",null,"Add New")))}))),j=n(5),S=n(6),C=n(8),T=n(7),k=n(9),V=n(19),A=(n(32),function(e){function t(){var e,n;Object(j.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(i)))).applyChanges=function(e){return n.props.applyChanges(e)},n.editComment=function(e){n.props.setIdForEdit(e.id),n.props.saveNewItem({link:e.imgUrl,comment:e.comment}),n.props.openPreview()},n}return Object(k.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this;return this.props.items.length?i.a.createElement(V.a,{className:"gallery",list:this.props.items,setList:this.applyChanges,animation:500,delayOnTouchStart:!0,delay:2},this.props.items.map((function(t){return i.a.createElement("div",{className:"g-item",key:t.id},i.a.createElement("div",{className:"g-item__image-wrapper"},i.a.createElement("i",{className:"g-item__delete material-icons",onClick:function(){return e.props.deleteItem(t.id)}},"close"),i.a.createElement("img",{className:"g-item__image",src:t.imgUrl,alt:"",onClick:function(){return e.props.openModal(t.imgUrl)}})),i.a.createElement("div",{className:"g-item__comment"},i.a.createElement("div",{className:"g-item__comment-edit"},i.a.createElement("span",null,"Comment:"),i.a.createElement("i",{className:"material-icons g-item__edit",title:"Edit comment",onClick:function(){return e.editComment(t)}},"edit")),i.a.createElement("p",{className:"g-item__comment-text"},t.comment.length?t.comment:"no comments yet")))}))):i.a.createElement("div",{className:"gallery_no-photos"},"You have no photos yet. To add, click on the button in the upper right.")}}]),t}(a.Component)),D=Object(c.b)((function(e){return{items:e.gallery.items}}),(function(e){return{applyChanges:function(t){return function(e){return function(t){localStorage.setItem("items",JSON.stringify(e)),t(I(e))}}(t)(e)},deleteItem:function(t){return function(e){return function(t){var n=JSON.parse(localStorage.getItem("items")||"[]");n=n.filter((function(t){return t.id!==e})),localStorage.setItem("items",JSON.stringify(n)),t(I(n))}}(t)(e)},saveNewItem:function(t){return e(v(t))},setIdForEdit:function(t){return e(h(t))},openPreview:function(){return e(N(!0))},openModal:function(t){return e(y({link:t,isVisible:!0}))}}}))(A),M=n(11),F=(n(33),function(e){function t(){var e,n;Object(j.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(i)))).state={imageUrl:"",comment:"",isButtonDisabled:!1},n.close=function(){n.setState((function(){return{imageUrl:"",comment:""}})),n.props.closeForm()},n.addNewImage=function(e){e.preventDefault(),n.setState((function(){return{isButtonDisabled:!0}}));var t=n.state,a=t.imageUrl,i=t.comment,r=n.props,o=r.isNotificationVisible,c=r.checkLink,l=r.saveNewItem,s=r.setPreloaderStatus;if((!a||!a.trim())&&!o)return n.props.showNotify("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443"),void n.setState((function(){return{isButtonDisabled:!1}}));navigator.onLine?(s(!0),c(a).then((function(e){if(!e.ok)return n.props.showNotify("\u0421\u0441\u044b\u043b\u043a\u0430 \u0431\u0438\u0442\u0430\u044f"),n.setState((function(){return{isButtonDisabled:!1}})),void s(!1);e.headers.get("Content-Type").includes("image")?(l({link:a,comment:i.trim()}),n.props.closeForm(),n.props.openPreview(),n.setState((function(){return{imageUrl:"",comment:"",isButtonDisabled:!1}}))):(n.props.showNotify("\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0435 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"),n.setState((function(){return{isButtonDisabled:!1}}))),s(!1)})).catch((function(e){n.props.showNotify("\u0421\u0441\u044b\u043b\u043a\u0430 \u0431\u0438\u0442\u0430\u044f"),n.setState((function(){return{isButtonDisabled:!1}})),s(!1)}))):(n.props.showNotify("\u041d\u0435\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f"),n.setState((function(){return{isButtonDisabled:!1}}))),n.setState((function(){return{isButtonDisabled:!1}}))},n}return Object(k.a)(t,e),Object(S.a)(t,[{key:"handleChangeValue",value:function(e){var t=e.currentTarget.getAttribute("data"),n=e.target.value;this.setState((function(){return Object(M.a)({},t,n)}))}},{key:"render",value:function(){var e=this;return this.props.isFormVisible?i.a.createElement("div",{className:"add-form__overlay"},i.a.createElement("form",{className:"add-form__form",onSubmit:this.addNewImage},i.a.createElement("i",{className:"material-icons add-form__close",onClick:this.close},"close"),i.a.createElement("p",{className:"add-form__heading"},"Add new picture"),i.a.createElement("div",{className:"add-form__input-wrapper"},i.a.createElement("p",{className:"add-form__explanation"},"Link:"),i.a.createElement("input",{data:"imageUrl",className:"add-form__link",type:"text",value:this.state.imageUrl,onChange:function(t){return e.handleChangeValue(t)},placeholder:"Enter image link"})),i.a.createElement("div",{className:"add-form__input-wrapper"},i.a.createElement("p",{className:"add-form__explanation"},"Comment:"),i.a.createElement("textarea",{data:"comment",className:"add-form__comment",cols:"30",rows:"3",value:this.state.comment,onChange:function(t){return e.handleChangeValue(t)},placeholder:"Enter comment (optional)"})),i.a.createElement("button",{className:"add-form__add-new",disabled:this.state.isButtonDisabled,onClick:this.addNewImage},"Next"))):null}}]),t}(a.Component)),B=Object(c.b)((function(e){var t=e.gallery,n=e.notification;return{isFormVisible:t.form.isVisible,isNotificationVisible:n.isVisible}}),(function(e){return{closeForm:function(){return e(g(!1))},showNotify:function(t){return O(t)(e)},checkLink:function(e){return function(e){return fetch("https://cors-anywhere.herokuapp.com/"+e)}(e)},saveNewItem:function(t){return e(v(t))},openPreview:function(){return e(N(!0))},setPreloaderStatus:function(t){return e(function(e){return{type:"CHANGE_PRELOADER_VISIBILITY",payload:e}}(t))}}}))(F),P=(n(34),Object(c.b)((function(e){return{notifications:e.notification.notifications}}))((function(e){var t=e.notifications,n=t.length?t.map((function(e){var t=e.isVisible?"notification notification_active":"notification";return i.a.createElement("li",{className:t,key:e.id},e.message)})):null;return i.a.createElement(i.a.Fragment,null,i.a.createElement("ul",{className:"notifications"},n))}))),L=(n(35),function(e){function t(){var e,n;Object(j.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(i)))).state={comment:""},n.onChange=function(e){var t=e.target.value;n.setState((function(){return{comment:t}}))},n.acceptEdits=function(){var e=n.props.item.link,t=n.state.comment;n.props.editableId?n.props.editItemById({id:n.props.editableId,comment:n.state.comment.trim()}):n.props.acceptEdits({imgUrl:e,comment:t.trim()}),n.onClose()},n.onClose=function(){n.props.saveNewItem({}),n.props.setIdForEdit(),n.props.onClose()},n}return Object(k.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.querySelector(".preview__comment-edit").focus(),this.setState((function(){return{comment:e.props.item.comment}}))}},{key:"render",value:function(){var e=this.props.item;return i.a.createElement("div",{className:"preview"},i.a.createElement("div",{className:"preview__box"},i.a.createElement("i",{className:"material-icons preview__close",onClick:this.onClose},"close"),i.a.createElement("p",{className:"preview__heading"},"Preview"),i.a.createElement("div",{className:"preview__data-wrapper"},i.a.createElement("div",{className:"preview__image-wrapper"},i.a.createElement("img",{src:e.link,alt:"",className:"preview__image"})),i.a.createElement("div",{className:"preview__comment-section"},i.a.createElement("p",{className:"preview__comment-heading"},"Can edit"),i.a.createElement("textarea",{className:"preview__comment-edit",value:this.state.comment,onChange:this.onChange}))),i.a.createElement("button",{className:"preview__accept",onClick:this.acceptEdits},"I agree")))}}]),t}(a.Component)),G=Object(c.b)((function(e){var t=e.gallery;return{isVisible:t.preview.isVisible,item:t.form.newItem,editableId:t.editableItemId}}),(function(e){return{onClose:function(){return e(N(!1))},acceptEdits:function(t){return function(e){return function(t){var n=JSON.parse(localStorage.getItem("items")||"[]"),a=Object(s.a)({id:Date.now()},e);localStorage.setItem("items",JSON.stringify([a].concat(Object(l.a)(n)))),t(function(e){return{type:"SET_NEW_ITEM",payload:e}}(a))}}(t)(e)},saveNewItem:function(t){return e(v(t))},setIdForEdit:function(){return e(h(null))},editItemById:function(t){return(n=t,function(e){var t=_.getState().gallery.items,a=n.id,i=t.findIndex((function(e){return e.id===a})),r=t[i],o=[].concat(Object(l.a)(t.slice(0,i)),[Object(s.a)({},r,{comment:n.comment})],Object(l.a)(t.slice(i+1)));localStorage.setItem("items",JSON.stringify(o)),e(I(o))})(e);var n}}}))(L),x=(n(36),Object(c.b)((function(e){return{isVisible:e.gallery.preloader.isVisible}}))((function(e){return e.isVisible?i.a.createElement("div",{className:"preloader"},i.a.createElement("div",{className:"lds-ripple"},i.a.createElement("div",null),i.a.createElement("div",null))):null}))),R=(n(37),Object(c.b)((function(e){return{imageModal:e.gallery.imageModal}}),(function(e){return{closeModal:function(){return e(y({link:"",isVisible:!1}))}}}))((function(e){var t=e.imageModal,n=e.closeModal;return t.isVisible?i.a.createElement("div",{className:"image-modal",onClick:function(e){return function(e){"image-modal"===e.target.className&&n()}(e)}},i.a.createElement("div",{className:"image-modal__wrapper"},i.a.createElement("div",{className:"image-modal__close"},i.a.createElement("i",{className:"material-icons image-modal__close-button",onClick:function(){return n()}},"close")),i.a.createElement("div",{className:"image-modal__image-wrapper"},i.a.createElement("img",{src:t.link,alt:""})))):null}))),U=(n(38),Object(c.b)((function(e){return{isPreviewVisible:e.gallery.preview.isVisible}}))((function(e){var t=e.isPreviewVisible;return i.a.createElement(i.a.Fragment,null,i.a.createElement(w,null),i.a.createElement("div",{className:"container"},i.a.createElement(D,null)),i.a.createElement(B,null),i.a.createElement(P,null),t?i.a.createElement(G,null):null,i.a.createElement(x,null),i.a.createElement(R,null))})));n(39);o.a.render(i.a.createElement(c.a,{store:_},i.a.createElement(U,null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.dfa80778.chunk.js.map